Save dir: results_dir/test_uni_v1_official_spatial_transformer::25-10-14-16-37-11
Namespace(seed=1, datasets=['READ'], use_wandb=True, source_dataroot='/root/data1/Reproduce/dataset/', embed_dataroot='/root/data1/Reproduce/dataset/embed_dataroot', gene_list='var_50genes.json', save_dir='results_dir/', feature_encoder='uni_v1_official', normalize_method='log1p', exp_code='test', device=0, sample_times=10, batch_size=2, lr=0.0005, epochs=100, clip_norm=1.0, save_step=-1, eval_step=1, num_workers=1, loss_func='mse', patch_distribution='uniform', n_genes=50, n_sample_steps=5, prior_sampler='zinb', zinb_logits=0.1, zinb_total_count=1, zinb_zi_logits=0.0, backbone='spatial_transformer', hidden_dim=128, pairwise_hidden_dim=128, n_layers=4, dropout=0.2, attn_dropout=0.2, n_neighbors=8, n_heads=4, feature_dim=1024, norm='layer', activation='swiglu')
Running dataset READ split 0
Dataset Loading
/root/data1/my_module/STFlow-source/stflow/flow/ZINB.py:24: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.total_count = torch.tensor(total_count, dtype=torch.float32)
/root/data1/my_module/STFlow-source/stflow/flow/ZINB.py:25: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.logits = torch.tensor(logits, dtype=torch.float32)
Training
epoch: 36, avg_loss: 0.429:  35%|███████████▉                      | 35/100 [14:11<26:21, 24.33s/it]
Early stopping
Running dataset READ split 1
Dataset Loading
/root/data1/my_module/STFlow-source/stflow/flow/ZINB.py:24: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.total_count = torch.tensor(total_count, dtype=torch.float32)
/root/data1/my_module/STFlow-source/stflow/flow/ZINB.py:25: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.logits = torch.tensor(logits, dtype=torch.float32)
Training
epoch: 25, avg_loss: 0.360:  24%|████████▏                         | 24/100 [10:29<33:12, 26.21s/it]
Early stopping
